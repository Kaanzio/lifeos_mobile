/* ==========================================
   LifeOS Mobile Optimizations - V3 (EXTREME COMPATIBILITY)
   ========================================== */

/* 1. ROOT & GLOBAL RESET */
:root {
    --bottom-nav-height: 70px;
    --mobile-padding: 15px;
    --sidebar-width: 0px !important;
}

@media (max-width: 991px) {

    html,
    body {
        width: 100% !important;
        height: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow-x: hidden !important;
        position: relative !important;
    }

    /* 2. LAYOUT CORE */
    #app {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
        height: 100% !important;
        opacity: 1 !important;
        overflow: hidden !important;
    }

    .main-content {
        margin-left: 0 !important;
        margin-top: 60px !important;
        /* Managed by header height */
        padding-bottom: var(--bottom-nav-height) !important;
        width: 100% !important;
        height: calc(100vh - 60px) !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
        display: block !important;
    }

    .pages-container {
        padding: 0 !important;
        margin: 0 !important;
        width: 100% !important;
        height: 100% !important;
    }

    .page {
        padding: var(--mobile-padding) !important;
        width: 100% !important;
        box-sizing: border-box !important;
        overflow-y: visible !important;
    }

    /* 3. HEADER SIMPLIFICATION */
    .header {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 60px !important;
        padding: 0 var(--mobile-padding) !important;
        background: rgba(15, 16, 22, 0.95) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        z-index: 1500 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: space-between !important;
        border-bottom: 1px solid var(--border-color) !important;
    }

    .header-left .header-clock,
    .header-left .header-divider,
    .header-right .search-bar,
    .header-right .header-profile-name,
    .header-right .header-profile-title,
    .header-left .logo {
        display: none !important;
    }

    .header-left {
        display: flex !important;
        align-items: center !important;
        gap: 10px !important;
    }

    /* 4. SIDEBAR (MOBILE MENU) */
    .sidebar {
        transform: translateX(-100%);
        width: 280px !important;
        height: 100% !important;
        top: 0 !important;
        left: 0 !important;
        z-index: 2500 !important;
        transition: transform 0.4s ease !important;
        position: fixed !important;
    }

    .sidebar.open {
        transform: translateX(0) !important;
    }

    .sidebar-overlay.active {
        display: block !important;
        position: fixed !important;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2400 !important;
    }

    /* 5. DASHBOARD - TRULY VERTICAL */
    .dashboard-main-grid {
        display: flex !important;
        flex-direction: column !important;
        gap: 20px !important;
        width: 100% !important;
    }

    .dashboard-panel {
        width: 100% !important;
        min-height: auto !important;
        border-radius: 16px !important;
    }

    .dashboard-banner-container {
        margin: 0 !important;
    }

    .dashboard-banner {
        flex-direction: column !important;
        height: auto !important;
        padding: 0 !important;
    }

    .dashboard-profile-info {
        width: 100% !important;
        margin: 0 !important;
        padding: 24px !important;
        background: rgba(0, 0, 0, 0.2) !important;
        border-radius: 0 !important;
    }

    .banner-welcome-text {
        width: 100% !important;
        flex-direction: column !important;
        padding: 24px !important;
        gap: 20px !important;
    }

    .banner-stats-row,
    .banner-stats-grid-modern {
        display: grid !important;
        grid-template-columns: repeat(2, 1fr) !important;
        width: 100% !important;
        min-width: 0 !important;
        gap: 12px !important;
    }

    .banner-stat-item {
        min-width: 0 !important;
        padding: 12px !important;
    }

    .quick-sites-grid {
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 10px !important;
        padding: 15px !important;
    }

    .quick-actions-grid {
        grid-template-columns: 1fr !important;
        padding: 15px !important;
    }

    /* 6. MODALS - BOTTOM SHEET STYLE */
    .modal-overlay {
        align-items: flex-end !important;
    }

    .modal-content {
        width: 100% !important;
        margin: 0 !important;
        border-radius: 20px 20px 0 0 !important;
        padding-bottom: env(safe-area-inset-bottom) !important;
    }

    /* 7. ALL GRIDS & LISTS */
    .books-grid,
    .shows-grid,
    .games-grid,
    .lessons-grid,
    .exams-grid,
    .sites-grid {
        grid-template-columns: 1fr !important;
        gap: 15px !important;
    }

    .stats-row {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
    }

    /* 8. KANBAN & PLANNING */
    .kanban-board {
        flex-direction: column !important;
        gap: 20px !important;
    }

    .kanban-column {
        width: 100% !important;
        min-height: auto !important;
    }

    .planning-header {
        flex-direction: column !important;
        gap: 15px !important;
    }

    /* 9. AUTH / LOGIN / LANDING */
    .landing-wrapper {
        flex-direction: column !important;
        padding: 40px 20px !important;
        gap: 40px !important;
        text-align: center !important;
        min-height: 100vh !important;
        justify-content: flex-start !important;
    }

    .landing-info {
        flex: none !important;
        width: 100% !important;
        gap: 25px !important;
    }

    .os-clock-large {
        font-size: 48px !important;
        margin-bottom: 20px !important;
    }

    .landing-tagline {
        font-size: 32px !important;
        line-height: 1.2 !important;
        margin-bottom: 15px !important;
    }

    .landing-description {
        font-size: 14px !important;
        line-height: 1.6 !important;
        width: 100% !important;
    }

    .landing-stats-grid {
        display: grid !important;
        grid-template-columns: 1fr !important;
        /* Stack stats vertically */
        gap: 15px !important;
        width: 100% !important;
    }

    .landing-stat-card {
        padding: 15px !important;
        flex-direction: row !important;
        /* Row layout for stacked stats */
        align-items: center !important;
        gap: 15px !important;
        text-align: left !important;
    }

    .stat-icon {
        width: 40px !important;
        height: 40px !important;
        flex-shrink: 0 !important;
    }

    .stat-value {
        font-size: 20px !important;
        margin: 0 !important;
    }

    .stat-label {
        font-size: 12px !important;
        margin: 0 !important;
    }

    .auth-card {
        width: 100% !important;
        max-width: 100% !important;
        padding: 25px !important;
        border-radius: 24px !important;
        background: rgba(15, 15, 20, 0.9) !important;
        /* More opaque on mobile */
        margin-bottom: 40px !important;
    }

    .auth-logo-container {
        transform: none !important;
        justify-content: center !important;
        margin-bottom: 25px !important;
        gap: 10px !important;
    }

    .auth-logo-premium {
        height: 60px !important;
        margin: 0 !important;
    }

    .logo-text-modern {
        font-size: 28px !important;
    }

    .auth-title {
        font-size: 20px !important;
    }

    .auth-subtitle {
        font-size: 13px !important;
        margin-bottom: 25px !important;
    }

    /* 10. UTILITY */
    .form-row {
        flex-direction: column !important;
    }

    input,
    select,
    textarea,
    button {
        font-size: 16px !important;
        /* Prevent iOS zoom */
    }

    /* BOTTOM NAV */
    .mobile-nav {
        display: flex !important;
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: var(--bottom-nav-height);
        background: rgba(10, 10, 15, 0.98);
        border-top: 1px solid var(--border-color);
        z-index: 2000;
        padding-bottom: env(safe-area-inset-bottom);
    }

    .mobile-nav-item {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: var(--text-secondary);
        font-size: 10px;
        gap: 4px;
        text-decoration: none !important;
    }

    .mobile-nav-item.active {
        color: var(--accent-purple);
    }
}

/* Fixes for very narrow screens */
@media (max-width: 350px) {

    .banner-stats-row,
    .banner-stats-grid-modern {
        grid-template-columns: 1fr !important;
    }

    .quick-sites-grid {
        grid-template-columns: repeat(2, 1fr) !important;
    }
}